#include <sys/types.h>
#include <string.h>
#include <stdio.h>
#include <stdlib.h>

#include "sirfutils.h"
#include "sirfmessage15.h"

extern char * malloc_options;

int
main(){
	struct sm15 *r;
	xbuf *packet;
	unsigned long *length;
	char m[100] = {	0xA0, 0xA2, 0x00, 0x5C, 0x0F, 0x19, 0x00, 0x19, 0x00,
			0x1C, 0x39, 0xA5, 0x3E, 0x12, 0x00, 0x4C, 0x6F, 0xA1,
			0x21, 0xE8, 0x88, 0x22, 0xEE, 0xC9, 0x51, 0x6F, 0xF0,
			0xDE, 0x16, 0xDA, 0x00, 0x00, 0x07, 0x08, 0xD2, 0x44,
			0x00, 0x19, 0x00, 0x1C, 0x3A, 0x2A, 0xDE, 0xF7, 0x27,
			0x33, 0xF5, 0x8C, 0xE7, 0x31, 0x3E, 0xF8, 0xD5, 0x05,
			0xCD, 0x93, 0x07, 0x13, 0x35, 0xA1, 0x0D, 0xA5, 0x33,
			0x16, 0xDA, 0x7E, 0x00, 0x19, 0x00, 0x1C, 0x3A, 0xAC,
			0x00, 0x67, 0xA1, 0x39, 0x6A, 0x6A, 0x00, 0x31, 0x26,
			0x7E, 0xD1, 0x20, 0x17, 0xEC, 0xBF, 0xBB, 0x7E, 0x1C,
			0xFF, 0xAA, 0x31, 0xDE, 0x0B, 0xBC, 0x22, 0x94, 0xB0,
			0xB3 };


	malloc_options = "AFGJXZ";
	packet = xballoc(100);
	packet->len = packet->max = 100;
	bcopy(&m, packet->buf, packet->len);

	printf("==============================================================\n");
	printf("type %d, len %d (%svalid)\n",
		sirf_type(packet), packet->len,
		sirf_is_valid(packet)?"":"in" );

	hexdump(packet->buf, packet->len);
	r = sirf_decode_message_15(packet);
	dump_message_15(r);
	free(r);

	xbfree(packet);
	return 0;
}

